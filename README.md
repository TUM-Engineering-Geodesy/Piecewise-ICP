<h1 align="center">Piecewise-ICP: Efficient and Robust Registration for 4D Point Clouds in Permanent Laser Scanning</h1>

<p align="center">
  <a href="https://www.asg.ed.tum.de/gds/team/yihui-yang/"><strong>Yihui Yang</strong></a> Â·
  <a href="https://www.asg.ed.tum.de/gds/holst/"><strong>Christoph Holst</strong></a><br>
  <a href="https://www.asg.ed.tum.de/gds/home/"><strong>Chair of Engineering Geodesy, TUM</strong></a>
</p>

<p align="center">
  <img src="assets/graphical_abstract.jpg" alt="Method overview of Piecewise-ICP" style="width:100%; height:auto;">
</p>

<br>  

This repository provides the implementation code and partial test data for the paper: [**Piecewise-ICP: Efficient and Robust Registration for 4D Point Clouds in Permanent Laser Scanning**](https://www.sciencedirect.com), published in the ISPRS Journal of Photogrammetry and Remote Sensing.

*__Piecewise-ICP__ can accurately register point cloud time series (__4D point clouds__) in a __robust__ and __efficient__ way, even when the point cloud undergoes large-scale deformation or changes.
It is a __target-free__ and __learning-free__ point cloud registration algorithm that does not rely on keypoint extraction or matching, nor does it require color or intensity information. It operates directly on geometric structures and is particularly well-suited for __fine registration__ tasks in laser scanning-based deformation monitoring.*

****
## Abstract
The permanent terrestrial laser scanning (PLS) system has significantly improved the temporal and spatial resolution of surface capture in geomonitoring tasks. Accurate registration of the four-dimensional (3D space + time) point clouds (4DPC) generated by PLS is the prerequisite for subsequent deformation analysis. However, due to the massive data volume and potential changes between scans, achieving automatic, efficient, and robust registration of 4DPC remains challenging, especially in scenarios lacking signalized and reliable targets. To address the challenges in target-free registration of 4DPC from PLS, we propose Piecewise-ICP, a robust and efficient fine registration method. Assuming the stable areas on monitored surfaces are locally planar, we employ supervoxel-based segmentation to generate planar patches from 4DPC. These patches are then refined and classified by comparing defined correspondence distances to a monotonically decreasing distance threshold, thus progressively eliminating unstable areas in an iterative process and preventing convergence to local minima. Subsequently, an improved point-to-plane ICP (Iterative Closest Point) is applied to the centroids of identified stable patches. We introduce the Level of Detection to determine the minimum distance threshold, mitigating the influence of outliers and surface changes on registration accuracy. Based on derived transformation uncertainties, we further smooth the transformation sequence using a Kalman filter, yielding more accurate registration parameters. We demonstrate our registration approach on two datasets: (1) Synthetic point cloud time series with predefined changes and transformation parameters, and (2) a real 4DPC dataset from a PLS system installed in the Alpine region for rockfall monitoring. Experimental results show that Piecewise-ICP improves the average registration accuracy by more than 50% compared to the target-based method and existing robust ICP variants such as Trimmed-ICP and Generalized-ICP.

